# Модуль LEGO для языка RCML
-------------------------------
Данный модуль для языка RCML обеспечивает простое подключение к роботу Lego, оснащенному модулем EV3, и предоставляет набор функций и осей для работы с ним.<br>
Модуль имеет конфигурационный файл, в котором необходимо указать порт через который осуществляется коммутация с модулем EV3. Перед работой модуль EV3 Lego робота должен быть сопряжен с компьютером.

*Например модуль робота подключен к порту COM3, тогда в config.ini необходимо указать connection=COM3*
Тогда config.ini должен выглядеть так:
```ini
    [connections]
    connection = COM3
```

Стоит обратить внимание, что config.ini должен находиться в одной директории с модулем.

Для обращения к моторам A,B,C,D используются цифры 1,2,3,4 соответственно.<br>
Для обращения к датчикам под номерами 1,2,3,4 используются соответствующие номера.<br>
На параметры функций **speed** и **percent** Также наложены ограничения.<br>
**speed** принимает значения [-100;100].<br>
**percent** принимает значения [0;100].<br>

При превышении указанных ограничений функция кидает исключение, которое можно обработать с помошью конструкции языка RCML try/catch.

####Доступные функции робота:
Определение  | Описание | Пример
------------  | -----------------  | ---------------
motorSetSpeed(**motor**, **speed**)  | Задает мотору **motor** скорость **speed** |  @lr->motorSetSpeed (2,20); Задает мотору **B** скорость 20.
motorOff(**motor**) | Выключает мотор **motor**. Мотор остановится не сразу. |  @lr->motorOff(3); Остановит мотор **C**
motorBreak(**motor**) | Останавливает мотор **motor**, используя тормоза. |  @lr->motorBreak(4); Остановит мотор **D**
motorSetDirection(**motor**, **direction**) | Устанавливает направление мотора **motor**. **direction**=0 задает направление мотора "назад". **direction**>=0 задает направление мотора "вперед" |  @lr->motorSetDirection(1,0); Установит направление мотора **А** "назад". 
motorGetDirection(**motor**) | Возвращает 1 если направление мотора **motor** установлено как "вперед", возвращает 0 если направление мотора **motor** установлено как "назад". Мотор остановится не сразу. |  RecievedDirection = @lr->motorGetDirection(3); 
motorMoveTo(**motor**, **speed**, **position**,**brake**) | Перемещает мотор **motor** в положение **position** со скоростью **speed**. **brake** = 0 - не использовать тормоз, **brake**>0 - использовать тормоз. |  @lr->motorMoveTo(2,10,200,0); Переместит мотор **B** в позицию 200 со скоростью 10 не используя тормоз.
motorGetTacho(**motor**) | Возвращает позицию мотора **motor**. |  RecievedTacho = @lr->motorGetTacho(3); 
motorResetTacho(**motor**) | Устанавливает текущую позицию мотора **motor** как нулевую. |  @lr->motorResetTacho(3); 
waitMotorToStop(**motor**) | Ждет пока остановится мотор **motor**. |  @lr->waitMotorToStop(3);
waitMultiMotorsToStop( **motorA**,**motorB**, **motorC**,**motorD**) | Ждет пока остановится несколько моторов. Если **motor**>0, то ждет остановки, если **motor** =0, то не ждет. |  @lr->waitMultiMotorsToStop(1,0,0,1); Ждет пока остановятся моторы **А** и **D**.
setTrackVehicle( **motorLeft**,**motorRight**, **LeftReverse**,**RightReverse**) | Логически сеоединяет 2 мотора **motorLeft** и **motorRight** в Track Vehicle(гусеничный транспорт). Позволяет обращаться к этим моторам как к единому целому и открывает дополнительные функции упрощающие управление. Left и Right Reverse  при значении >0 задает моторам обратное направление. |  @lr->setTrackVehicle(2,3,1,0); Логически соединяет моторы **B** и **C** в Track, при этом мотор **B** изменяет сове направление на обратное.
trackVehicleBackward( **speed**) | Track Vehicle движется назад со скоростью **speed**. |  @lr->trackVehicleBackward(20); 
trackVehicleForward( **speed**) | Track Vehicle движется вперед со скоростью **speed**. |  @lr->trackVehicleForward(40); 
trackVehicleOff() | Выключает моторы Track Vehicle. Моторы остановится не сразу. |  @lr->trackVehicleOff();
trackVehicleBrake() | Останавливает моторы Track Vehicle, используя тормоза. |  @lr->trackVehicleBrake();
trackVehicleSpinLeft(**speed**) | Track Vehicle поворачивается влево вокруг своей вертикальной оси. |  @lr->trackVehicleSpinLeft(10); 
trackVehicleSpinRight(**speed**) | Track Vehicle поворачивается вправо вокруг своей вертикальной оси. |  @lr->trackVehicleSpinRight(90)
trackVehicleTurnLeftForward( **speed**, **percent**) |  Track Vehicle поворачивает влево, двигаясь вперед. Правый мотор будет иметь со скорость **speed**, а левый **(speed - speed*percent/100)**. Таким образом если **percent**=0 то моторы будут иметь одинковую скорость, а при **percent**=100 левый мотор будет иметь нулевую скорость.  |  @lr->trackVehicleTurnLeftForward(20, 50);
trackVehicleTurnRightForward( **speed**, **percent**) | Track Vehicle поворачивает влево, двигаясь вперед. Левый мотор будет иметь со скорость **speed**, а правый **(speed - speed*percent/100)**. Таким образом если **percent**=0 то моторы будут иметь одинковую скорость, а при **percent**=100 правый мотор будет иметь нулевую скорость. |  @lr->trackVehicleTurnRightForward(10, 90);
trackVehicleTurnLeftReverse( **speed**, **percent**)  | Track Vehicle поворачивает влево, двигаясь назад. Скорость правого мотора равна **speed**,  а левого **(speed - speed*percent/100)** |  @lr->trackVehicleTurnLeftReverse(10,20); 
trackVehicleTurnRightReverse( **speed**, **percent**)  | Track Vehicle поворачивает вправо, двигаясь назад. Скорость левого мотора равна **speed**,  а правого **(speed - speed*percent/100)** |  @lr->trackVehicleTurnRightReverse(50,50); 
readSensor( **sensor**, **mode**)  | Считывает показания сенсора под номером **sensor** в режиме **mode**. Для разных датчиков существует разное количество режимов. |  @lr->readSensor(2,1); Считывает показания датчика подключенного к порту 2 в режиме 1.


#####Режимы датчиков:

Для данного модуля доступно подключение датчиков 5 типов.

Датчик | Режим
------------  | ----------------- 
Ультразвуковой | 1 - режим определения расстояния в сантиметрах<br> 2 - режим определения расстояния в дюймах<br> 3 - режим прослушивания
Инфракрасный | 1 - режим определения расстояния<br> 2 - режим определения местоположения инфракрасного дистанционного пульта<br> 3- режим определения нажатия кнопок на инфракрасном пульте
Цветовой | 1 - режим определения интенсивности света<br> 2 - режим определения цвета<br> 3- режимопределения raw значения отраженного света <br> 4 - режим определения отраженного света
Гироскопический | 1 - режим определения угла в градусах<br> 2 - режим определения угловой скорости в градусах в секунду 
Датчик нажатия | 1 - режим отслеживания нажатия<br> 2 - режим вывода количества нажатий



####Оси робота:

Ось| Верхняя граница | Нижняя граница | Описание 
------------  | ----------------- | -------------- | ---------------
locked | 1 | 0 | Бинарная ось. Если её значение равно 1, то робот считается заблокированным и игнорирует изменение значений по любым другим осям.
speedMotorA | 100 | -100 | Значение оси задает скорость мотора подключенного к порту **A**.
speedMotorB | 100 | -100 | Значение оси задает скорость мотора подключенного к порту **B**.
speedMotorC | 100 | -100 | Значение оси задает скорость мотора подключенного к порту **C**.
speedMotorD | 100 | -100 | Значение оси задает скорость мотора подключенного к порту **D**.
moveMotorA | 1000 | -1000 | Значение оси задает позицию на которую повернется мотор **A** со скоростью 50.
moveMotorB | 1000 | -1000 | Значение оси задает позицию на которую повернется мотор **B** со скоростью 50.
moveMotorC | 1000 | -1000 | Значение оси задает позицию на которую повернется мотор **C** со скоростью 50.
moveMotorD | 1000 | -1000 | Значение оси задает позицию на которую повернется мотор **D** со скоростью 50.
straight | 100 | -100 | Значение оси задает скорость с которой прямолинейно перемещается Track Vheicle(он должен быть инициализирован прежде чем будет задействована эта ось).
rotation | 100 | -100 | Значение оси задает скорость с  которой Track Vheicle вращается вокруг своей вертикальной оси(он должен быть инициализирован прежде чем будет задействована эта ось).




